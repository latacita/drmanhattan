package servidor;

import java.net.ServerSocket;
import java.net.Socket;
import java.util.logging.FileHandler;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.logging.SimpleFormatter;

import comun.Global;

/**
 * 
 * Clase encargada de aceptar nuevos clientes.
 * 
 * @author Manuel Pando Muñoz
 *
 */
public class HiloAceptadorClientes extends Thread{

	//para aceptar conexiones
	private ServerSocket sSocket;

	//con valor true se dejan de aceptar clientes nuevos
	private boolean desconectar;

	/**
	 * Constructor
	 */
	public HiloAceptadorClientes(){
		try{
			//Inicializa las variables
			desconectar = false;
			sSocket = new ServerSocket(Global.PUERTOSERVIDOR);
			this.start();

			Logger logger = Logger.getLogger("MyLog");
			FileHandler fh;


			// This block configure the logger with handler and formatter
			fh = new FileHandler("c:\\MyLogFile.log", true);
			logger.addHandler(fh);
			logger.setLevel(Level.ALL);
			SimpleFormatter formatter = new SimpleFormatter();
			fh.setFormatter(formatter);

			// the following statement is used to log any messages   
			logger.log(Level.WARNING,"My first log");


		}catch(Exception e){
			//TODO tratamiento de errores
			e.printStackTrace();
		}
	}


	public void run(){
		try{			
			while(!desconectar){
				Socket socket;

				//esperar a nueva conexion
				socket = sSocket.accept();

				/*
				 * TODO
				 * Utilizar el socket creado, crear un hilo para la interaccion entre cliente y servidor
				 *  
				 */				
			}
		}catch(Exception e){
			//TODO tratamiento de errores
			e.printStackTrace();
		}
	}
}